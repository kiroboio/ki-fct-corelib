// Init dotenv
import * as dotenv from "dotenv";
import { writeFileSync } from "fs";

import { BatchMultiSigCall, ethers } from "../src";
import { transactionValidator } from "../src/utils";
import FCTData from "./Failing.json";
import { scriptData } from "./scriptData";

dotenv.config();

const activator = "0x4c508dc4a3aacbecbf13c1d543b4936274033110";

async function main() {
  const FCT = BatchMultiSigCall.from(FCTData);

  writeFileSync("./Failing2.json", JSON.stringify(FCT.export(), null, 2));

  const txValidator = await transactionValidator({
    callData: FCT.utils.getCalldataForActuator({
      activator: activator,
      investor: ethers.constants.AddressZero,
      purgedFCT: ethers.constants.HashZero,
      signatures: [
        FCT.utils.getAuthenticatorSignature(),
        {
          r: "0xe445c4c72b6f843b0e9b26ed199552021c37b5fabe1ce71498c5cbf156c6a9e6",
          s: "0x213066e0db3d40e3249005a0aae3fa4e451b1cd24a2df378346401a4c9ab8886",
          v: 28,
        },
      ],
    }),
    activateForFree: false,
    actuatorContractAddress: "0x862a8fb429195d735106c06c4e352e305d8c7b31",
    activator: activator,
    rpcUrl: scriptData[5].rpcUrl,
    gasPrice: {
      maxFeePerGas: ethers.utils.parseUnits("13", "gwei").toString(),
      maxPriorityFeePerGas: ethers.utils.parseUnits("0.004", "gwei").toString(),
    },
  });

  console.log(txValidator);
}

main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exitCode = 1;
  });

// Doesnt work
// 0x58cdbf8e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000004c508dc4a3aacbecbf13c1d543b493627403311000000000000000000000000000000000000000000000000000000000000005a47d971612020101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c508dc4a3aacbecbf13c1d543b4936274033110c24174393d3e5c1b778b81abc45fdf8788d239764b196587c3c2f35aa9393620651f9c00020101000000000000006553eddf00654a36cf000012309ce540000c7ba02b615fd7df64325b881de412f9011e8d599d6d26803faaf4e3b1ebb0da8ac5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a4706eb0f8f12370d266373a3bac54965cc0cc7414d259a5628d003f93e54eff040ec5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000048000000000000000000000000000000000000000000000000000000000000004a000000000000000000000000000000000000000000000000000000000000004c000000000000000000000000000000000000000000000000000000000000004e0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000206ef4a0f94bc9a32657a5fdc44696861d4020c1440fb1da9b0c3b0efef49f6ce6c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470a9059cbb2ab09eb219583f4a59a5d0623ade346d962bcd4e46b11da047c9049b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000100010000000004000000000000000000000000021f36676ed2668d7a12d52b189fd39124523d3c00000000000000000000000075ab5ab1eef154c0352fc31d2428cef80c7f8b33000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000318524eb81b25f11218a8f4d62fc78480167e87b00000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001ab417ec609cb037959b0c70e63c0735becdd78c138b13dae319cb4f3a79a5b302b92db4d8522ec81a39de4c78c9c0ce02e36820104d47a9114b0107c16f9ce0e000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

// Works
// 0x58cdbf8e00000000000000000000000000000000000000000000000000000000000000400000000000000000000000004c508dc4a3aacbecbf13c1d543b493627403311000000000000000000000000000000000000000000000000000000000000006047d971612020101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004c508dc4a3aacbecbf13c1d543b4936274033110c24174393d3e5c1b778b81abc45fdf8788d239764b196587c3c2f35aa9393620651f9c00020101000000000000006553eddf00654a36cf000012309ce540000c7ba02b615fd7df64325b881de412f9011e8d599d6d26803faaf4e3b1ebb0da8ac5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a4706eb0f8f12370d266373a3bac54965cc0cc7414d259a5628d003f93e54eff040ec5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000004e0000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000005200000000000000000000000000000000000000000000000000000000000000540000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000206ef4a0f94bc9a32657a5fdc44696861d4020c1440fb1da9b0c3b0efef49f6ce6c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470a9059cbb2ab09eb219583f4a59a5d0623ade346d962bcd4e46b11da047c9049b00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000100010000000004000000000000000000000000021f36676ed2668d7a12d52b189fd39124523d3c00000000000000000000000075ab5ab1eef154c0352fc31d2428cef80c7f8b33000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000040000000000000000000000000318524eb81b25f11218a8f4d62fc78480167e87b00000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002ab417ec609cb037959b0c70e63c0735becdd78c138b13dae319cb4f3a79a5b302b92db4d8522ec81a39de4c78c9c0ce02e36820104d47a9114b0107c16f9ce0e000000000000000000000000000000000000000000000000000000000000001be445c4c72b6f843b0e9b26ed199552021c37b5fabe1ce71498c5cbf156c6a9e6213066e0db3d40e3249005a0aae3fa4e451b1cd24a2df378346401a4c9ab8886000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
